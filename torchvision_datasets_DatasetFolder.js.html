<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: torchvision/datasets/DatasetFolder.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: torchvision/datasets/DatasetFolder.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { VisionDataset } from "./VisionDataset";

import { makeDataset } from "./utilities";
import { DefaultTransform } from "../transforms/transforms";

const { lstatSync, readdirSync } = require("fs");
const { join, resolve } = require("path");

/**
 * A representation of a PyTorch Dataset folder class.
 * Dervied from the [PyTorch DatasetFolder class]{@link https://pytorch.org/docs/stable/_modules/torchvision/datasets/folder.html#DatasetFolder}
 * @extends VisionDataset
 */
export class DatasetFolder extends VisionDataset {
  /**
   * Create a new Dataset folder object
   * @param {string} root - Root directory to Dataset Folder
   * @param {Function} loader - Function used to load files in root folder
   * @param {string[]} extensions - Accepted extensions for loading
   * @param {Object} transform - Transform object to apply to every object
   * @param {Function} isValidFile - Function to validate if a file is valid or not
   */
  constructor(
    root,
    loader,
    extensions = null,
    transform = new DefaultTransform(),
    isValidFile = null
  ) {
    super(root, loader, extensions, transform, isValidFile);
    this.findClasses();

    const samples = makeDataset(
      root,
      this.classToIdx,
      this.extensions,
      this.isValidFile
    );

    /**
     * A collection of samples used to load the underlying files
     * @type {Array.&lt;{path: String, classIndex: Number }>}
     */
    this.samples = samples;
    /**
     * A list of class targets for given samples
     * @type {Number[]}
     */
    this.targets = samples.map((entry) => entry[1]);
  }

  /**
   * Given an index of an item, retrieve the sample, load it up, and potentially transform it if needed
   * @param {Number} index The index of the sample being fetched
   * @returns {{sample: File, target: Number}} An object containing the sample being loaded, along with its class index
   */
  getItem = (index) => {
    const { path, classIndex } = this.samples[index];
    let sample = this.loader(path);

    if (this.transform !== null) {
      sample = this.transform(sample);
    }

    return { sample, target: classIndex };
  };

  /**
   * Fetch the number of samples being accessed
   * @returns {Number} The length of the samples array
   *
   */
  length = () => this.samples.length;

  /**
   * Find the number of classes present given a root dataset
   * @returns {{classes: string[], classToIdx: Object&lt;string, number>}} An array of the classes present in the root directory, as well as a mapping from class to index
   */
  findClasses = () => {
    const isDirectory = (source) => lstatSync(source).isDirectory();

    const getDirectories = (source) => {
      const directories = [];
      const results = readdirSync(source);

      results.forEach((result) => {
        if (isDirectory(join(source, result))) {
          directories.push(result);
        }
      });

      return directories;
    };

    const rootDir = resolve(this.dataset);
    const classes = getDirectories(rootDir);
    const classToIdx = {};
    classes.forEach((className, index) => {
      classToIdx[className] = index;
    });

    this.classes = classes;
    this.classToIdx = classToIdx;
  };
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-load.html">load</a></li><li><a href="module-utilities.html">utilities</a></li><li><a href="pytorchjs.module_pytorchjs_torch.html">pytorchjs/torch</a></li><li><a href="pytorchjs.module_pytorchjs_torchvision.html">pytorchjs/torchvision</a></li><li><a href="pytorchjs_torch.module_pytorchjs_torch_utils.html">pytorchjs/torch/utils</a></li><li><a href="pytorchjs_torch_utils.module_pytorchjs_torch_utils_data.html">pytorchjs/torch/utils/data</a></li><li><a href="pytorchjs_torchvision.module_pytorchjs_torchvision_datasets.html">pytorchjs/torchvision/datasets</a></li><li><a href="pytorchjs_torchvision.module_pytorchjs_torchvision_transforms.html">pytorchjs/torchvision/transforms</a></li></ul><h3>Classes</h3><ul><li><a href="Compose.html">Compose</a></li><li><a href="DataLoader.html">DataLoader</a></li><li><a href="Dataset_Dataset.html">Dataset</a></li><li><a href="DatasetFolder.html">DatasetFolder</a></li><li><a href="DatasetFolder_Dataset.html">Dataset</a></li><li><a href="DefaultTransform.html">DefaultTransform</a></li><li><a href="Grayscale.html">Grayscale</a></li><li><a href="ImageFolder.html">ImageFolder</a></li><li><a href="ImageFolder_Dataset.html">Dataset</a></li><li><a href="InvertAxes.html">InvertAxes</a></li><li><a href="Model.html">Model</a></li><li><a href="module-pytorchjs_torch_utils_data.Dataset.html">Dataset</a></li><li><a href="Normalize.html">Normalize</a></li><li><a href="Resize.html">Resize</a></li><li><a href="VisionDataset.html">VisionDataset</a></li><li><a href="VisionDataset_Dataset.html">Dataset</a></li></ul><h3>Global</h3><ul><li><a href="global.html#pytorchjs">pytorchjs</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.6</a> on Tue Dec 08 2020 13:52:49 GMT+0000 (Coordinated Universal Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
